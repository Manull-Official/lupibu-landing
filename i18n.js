/* ========================================
   LUPIBU LANDING - INTERNATIONALIZATION
   ======================================== */

const translations = {
    en: {
        // Nav
        'nav.features': 'Features',
        'nav.howItWorks': 'How It Works',
        'nav.reviews': 'Reviews',
        'nav.contact': 'Contact',
        'nav.download': 'Download',

        // Hero
        'hero.badge': 'Your child\'s growth companion',
        'hero.title': '<span class="hero-title-sm">They grow so fast</span><span class="gradient-text">Don\'t miss a thing</span>',
        'hero.subtitle': 'Feedings, sleep, growth, milestones — your baby\'s world changes every day. Lupibu keeps it all in one place so you can worry less and be present more. And when your hands are full, just say it — AI will log it for you.',
        'hero.comingDate': 'Available March 1',
        'hero.appStore': 'App Store',
        'hero.stat1Value': 'AI',
        'hero.stat1Label': 'Voice input',
        'hero.stat2Value': '0',
        'hero.stat2Label': 'Ads',
        'hero.stat3Value': '< 5s',
        'hero.stat3Label': 'To log an event',

        // Features
        'features.label': 'Everything in one app',
        'features.title': 'Track the past. Plan ahead.<br>Enjoy the moment.',
        'features.subtitle': 'From daily routines to big milestones — Lupibu gives you clarity in the beautiful chaos of parenthood.',
        'features.voice.title': 'Hands busy? Just speak',
        'features.voice.desc': 'Press the mic and say what happened — "ate porridge 150 grams", "fell asleep at 2pm". AI understands natural speech in English, Russian, and Kazakh. No typing needed.',
        'features.voice.tag': 'AI Voice',
        'features.growth.title': 'Growth charts you can trust',
        'features.growth.desc': 'Record weight, height, and teeth — see them plotted on WHO curves with full history. Walk into the pediatrician\'s office with confidence.',
        'features.milestones.title': 'Every first, captured forever',
        'features.milestones.desc': 'First smile, first steps, first tooth — mark milestones, attach photos, get confetti, and share a beautiful card with grandma.',
        'features.calendar.title': 'Your day at a glance',
        'features.calendar.desc': 'Visual timeline of everything that happened — and everything planned. Edit, delete, use timers. Past events and future schedules in one view.',
        'features.reminders.title': 'Schedules, timers & reminders',
        'features.reminders.desc': 'Use built-in sleep and feeding schedules, set timers for any event, get gentle nudges when it\'s time. Plan ahead — Lupibu remembers so you don\'t have to.',
        'features.multiChild.title': 'Multiple children',
        'features.multiChild.desc': 'Add as many kids as you need and switch between them in a tap. Each child gets their own timeline, charts, and milestones.',
        'features.photos.title': 'Photos on every event',
        'features.photos.desc': 'Attach photos to any entry — snap the doctor\'s prescription, capture a milestone moment, save what matters where it belongs.',
        'features.articles.title': 'Articles by age',
        'features.articles.desc': 'Pediatrician-backed articles matched to your child\'s current stage. The right answers at the right time.',

        // How It Works
        'howItWorks.label': 'How It Works',
        'howItWorks.title': 'Three steps to calmer parenting',
        'howItWorks.step1.title': 'Add your little one',
        'howItWorks.step1.desc': 'Name, birthday, photo — 30 seconds and you\'re ready. Add as many children as you need.',
        'howItWorks.step2.title': 'Speak or tap',
        'howItWorks.step2.desc': 'Record events by voice or pick from the list. Use timers, attach photos, edit anything — your way.',
        'howItWorks.step3.title': 'Watch them grow',
        'howItWorks.step3.desc': 'Growth charts, milestones, daily timeline — Lupibu turns your entries into a story you\'ll want to revisit.',

        // Testimonials
        'testimonials.label': 'Parents say',
        'testimonials.title': 'They tried it. They stayed.',
        'testimonials.t1.text': '"I was skeptical about voice input. Then I tried saying \'ate banana 50 grams\' while rocking my baby — and it just worked. I can\'t go back to typing."',
        'testimonials.t1.name': 'Anna K.',
        'testimonials.t1.role': 'Mom, 8-month baby',
        'testimonials.t2.text': '"The growth charts calmed my anxiety. Seeing my son right on the WHO curve made me breathe easier at the pediatrician visit."',
        'testimonials.t2.name': 'Dmitry S.',
        'testimonials.t2.role': 'First-time dad',
        'testimonials.t3.text': '"When my daughter took her first steps, I got confetti in the app and a gorgeous card to send to grandma. Such a lovely touch."',
        'testimonials.t3.name': 'Aigerim T.',
        'testimonials.t3.role': 'Mom of two',

        // CTA
        'cta.title': 'Your baby\'s story starts here',
        'cta.subtitle': 'Basic features are free. No ads.',

        // Contact
        'contact.label': 'Get in Touch',
        'contact.title': 'Have a question or idea?',
        'contact.subtitle': 'We\'d love to hear from you. Drop us a message and we\'ll get back to you soon.',
        'contact.name': 'Name',
        'contact.namePlaceholder': 'Your name',
        'contact.email': 'Email',
        'contact.emailPlaceholder': 'your@email.com',
        'contact.message': 'Message',
        'contact.messagePlaceholder': 'How can we help?',
        'contact.send': 'Send Message',
        'contact.success': 'Your email client will open now. Thank you!',

        // Footer
        'footer.tagline': 'Just say it. We\'ll remember.',
        'footer.product': 'Product',
        'footer.product.features': 'Features',
        'footer.product.howItWorks': 'How It Works',
        'footer.product.contact': 'Contact',
        'footer.legal': 'Legal',
        'footer.legal.privacy': 'Privacy Policy',
        'footer.legal.terms': 'Terms of Use',
        'footer.legal.disclaimer': 'Medical Disclaimer',
        'footer.legal.dataConsent': 'Data Consent',
        'footer.copyright': '\u00a9 2026 Lupibu. All rights reserved.',

        // Meta
        'meta.description': 'Lupibu — your child\'s growth companion. Track feedings, sleep, growth on WHO charts, milestones, schedules — all in one app. AI voice input in 3 languages.',
        'meta.title': 'Lupibu \u2014 They Grow So Fast. Don\'t Miss a Thing'
    },

    // ============================================
    // РУССКИЙ — транскреация
    // Тон: тёплый, на «ты», подруга рядом
    // ============================================
    ru: {
        'nav.features': 'Возможности',
        'nav.howItWorks': 'Как это работает',
        'nav.reviews': 'Отзывы',
        'nav.contact': 'Контакты',
        'nav.download': 'Скачать',

        'hero.badge': 'Помощник в развитии малыша',
        'hero.title': '<span class="hero-title-sm">Они растут так быстро</span><span class="gradient-text">Не упусти ни дня</span>',
        'hero.subtitle': 'Кормления, сон, рост, первые достижения — мир малыша меняется каждый день. Lupibu соберёт всё в одном месте, чтобы меньше тревог — и больше моментов рядом. А когда руки заняты — просто скажи, ИИ всё запишет.',
        'hero.comingDate': 'Доступно с 1 марта',
        'hero.appStore': 'App Store',
        'hero.stat1Value': 'ИИ',
        'hero.stat1Label': 'Голосовой ввод',
        'hero.stat2Value': '0',
        'hero.stat2Label': 'Рекламы',
        'hero.stat3Value': '< 5с',
        'hero.stat3Label': 'Записать событие',

        'features.label': 'Всё в одном приложении',
        'features.title': 'Записывай прошлое. Планируй будущее.<br>Наслаждайся моментом.',
        'features.subtitle': 'От ежедневной рутины до больших достижений — Lupibu помогает разобраться в прекрасном хаосе родительства.',
        'features.voice.title': 'Руки заняты? Просто скажи',
        'features.voice.desc': 'Нажми на микрофон и расскажи — «поел кашу 150 грамм», «уснул в два». ИИ понимает живую речь на русском, казахском и английском. Набирать ничего не нужно.',
        'features.voice.tag': 'ИИ',
        'features.growth.title': 'Графики роста, которым доверяешь',
        'features.growth.desc': 'Вес, рост и зубки — на графиках ВОЗ с полной историей. Иди к педиатру с уверенностью, а не с тревогой.',
        'features.milestones.title': 'Каждое «впервые» — навсегда',
        'features.milestones.desc': 'Первая улыбка, первые шаги, первый зубик — отмечай, прикрепляй фото, лови конфетти и отправляй открытку бабушке.',
        'features.calendar.title': 'Весь день — как на ладони',
        'features.calendar.desc': 'Визуальный таймлайн всего, что было — и всего, что запланировано. Редактируй, удаляй, используй таймеры. Прошлое и будущее в одном экране.',
        'features.reminders.title': 'Расписания, таймеры и напоминания',
        'features.reminders.desc': 'Готовые расписания сна и кормлений, таймеры для любого события, мягкие напоминания. Планируй наперёд — Lupibu запомнит за тебя.',
        'features.multiChild.title': 'Несколько детей',
        'features.multiChild.desc': 'Добавляй сколько угодно малышей и переключайся одним касанием. У каждого — свой таймлайн, графики и достижения.',
        'features.photos.title': 'Фото к каждому событию',
        'features.photos.desc': 'Прикрепляй фото к любой записи — назначение врача, первые шаги, важный момент. Всё там, где нужно, а не в галерее.',
        'features.articles.title': 'Статьи по возрасту',
        'features.articles.desc': 'Материалы от педиатров — под текущий этап развития. Нужные ответы в нужный момент.',

        'howItWorks.label': 'Как это работает',
        'howItWorks.title': 'Три шага к спокойному родительству',
        'howItWorks.step1.title': 'Добавь малыша',
        'howItWorks.step1.desc': 'Имя, дата рождения, фото — полминуты, и готово. Добавляй столько детей, сколько нужно.',
        'howItWorks.step2.title': 'Скажи или нажми',
        'howItWorks.step2.desc': 'Записывай события голосом или выбирай из списка. Используй таймеры, прикрепляй фото, редактируй — как тебе удобно.',
        'howItWorks.step3.title': 'Наблюдай, как растут',
        'howItWorks.step3.desc': 'Графики роста, достижения, дневной таймлайн — Lupibu превратит записи в историю, которую захочется пересматривать.',

        'testimonials.label': 'Мамы и папы говорят',
        'testimonials.title': 'Попробовали — полюбили',
        'testimonials.t1.text': '«Думала, голосовой ввод — баловство. Укачивала дочку, сказала «поела банан 50 грамм» — и всё записалось само. Набирать вручную? Ни за что.»',
        'testimonials.t1.name': 'Аня К.',
        'testimonials.t1.role': 'Мама, дочке 8 месяцев',
        'testimonials.t2.text': '«Перед приёмом в поликлинике открыл графики роста — сын точно по кривой ВОЗ. Педиатр даже спросила, что за приложение.»',
        'testimonials.t2.name': 'Дима С.',
        'testimonials.t2.role': 'Папа первенца',
        'testimonials.t3.text': '«Дочка сделала первые шаги — а в приложении конфетти и красивая открытка. Отправила бабушке, та расплакалась от счастья.»',
        'testimonials.t3.name': 'Айгерим Т.',
        'testimonials.t3.role': 'Мама двоих',

        'cta.title': 'Они так быстро растут. Не упусти ни дня.',
        'cta.subtitle': 'Базовые функции — бесплатно. Без рекламы.',

        'contact.label': 'Напиши нам',
        'contact.title': 'Есть вопрос или идея?',
        'contact.subtitle': 'Мы рады обратной связи. Напиши — ответим как можно скорее.',
        'contact.name': 'Имя',
        'contact.namePlaceholder': 'Как тебя зовут',
        'contact.email': 'Email',
        'contact.emailPlaceholder': 'твой@email.com',
        'contact.message': 'Сообщение',
        'contact.messagePlaceholder': 'Чем можем помочь?',
        'contact.send': 'Отправить',
        'contact.success': 'Сейчас откроется почтовый клиент. Спасибо!',

        'footer.tagline': 'Они растут — мы записываем.',
        'footer.product': 'Продукт',
        'footer.product.features': 'Возможности',
        'footer.product.howItWorks': 'Как это работает',
        'footer.product.contact': 'Контакты',
        'footer.legal': 'Документы',
        'footer.legal.privacy': 'Политика конфиденциальности',
        'footer.legal.terms': 'Условия использования',
        'footer.legal.disclaimer': 'Медицинская оговорка',
        'footer.legal.dataConsent': 'Согласие на обработку данных',
        'footer.copyright': '\u00a9 2026 Lupibu. Все права защищены.',

        'meta.description': 'Lupibu — помощник в развитии малыша. Кормления, сон, рост по ВОЗ, достижения, расписания, фото — всё в одном приложении. Голосовой ввод с ИИ.',
        'meta.title': 'Lupibu \u2014 Они растут так быстро. Не упусти ни дня'
    },

    // ============================================
    // ҚАЗАҚША — транскреация
    // Тон: жылы, құрметті «Сіз», отбасылық
    // ============================================
    kk: {
        'nav.features': 'Мүмкіндіктер',
        'nav.howItWorks': 'Қалай жұмыс істейді',
        'nav.reviews': 'Пікірлер',
        'nav.contact': 'Байланыс',
        'nav.download': 'Жүктеу',

        'hero.badge': 'Балаңыздың сенімді серігі',
        'hero.title': '<span class="hero-title-sm">Көз ілеспей өсіп кетеді</span><span class="gradient-text">Бір сәтін де жіберіп алмаңыз</span>',
        'hero.subtitle': 'Тамақтану, ұйқы, бой өсу, алғашқы жетістіктер — сәбиіңіздің әлемі күн сайын өзгереді. Lupibu бәрін бір жерде сақтайды, сіз уайымдамай, жанында болыңыз. Ал қолыңыз бос болмаса — айта салыңыз, жасанды интеллект өзі жазып қояды.',
        'hero.comingDate': '1 наурыздан',
        'hero.appStore': 'App Store',
        'hero.stat1Value': 'ЖИ',
        'hero.stat1Label': 'Дауыспен жазу',
        'hero.stat2Value': '0',
        'hero.stat2Label': 'Жарнама',
        'hero.stat3Value': '< 5с',
        'hero.stat3Label': 'Жазу жылдамдығы',

        'features.label': 'Бәрі бір қосымшада',
        'features.title': 'Өткенді жазыңыз. Болашақты жоспарлаңыз.<br>Әр сәтті қадірлеңіз.',
        'features.subtitle': 'Күнделікті тірліктен ірі жетістіктерге дейін — Lupibu ата-ана болудың қуанышты да қызу кезеңінде тірегіңіз болады.',
        'features.voice.title': 'Қолыңыз бос емес пе? Айта салыңыз',
        'features.voice.desc': 'Микрофонды басып, не болғанын айтыңыз — «ботқа жеді 150 грамм», «сағат екіде ұйықтады». Жасанды интеллект қазақша, орысша, ағылшынша тірі сөзді түсінеді. Теруге уақыт кетірмейсіз.',
        'features.voice.tag': 'ЖИ',
        'features.growth.title': 'Сенімді өсу графиктері',
        'features.growth.desc': 'Салмақ, бой, тістер — ДДҰ нормалары бойынша толық тарихы бар графикте. Педиатрға барғанда өзіңізге сенімді болыңыз.',
        'features.milestones.title': 'Әр «алғашқы» — мәңгілік естелік',
        'features.milestones.desc': 'Алғашқы күлкі, алғашқы қадам, алғашқы тіс — белгілеңіз, фото тіркеңіз, конфетти ұшырыңыз, әжеге ашықхат жіберіңіз.',
        'features.calendar.title': 'Бүкіл күніңіз — көз алдыңызда',
        'features.calendar.desc': 'Не болғанын, не жоспарланғанын визуалды таймлайннан көріңіз. Өзгертіңіз, жойыңыз, таймер қойыңыз. Өткен мен болашақ — бір экранда.',
        'features.reminders.title': 'Кестелер, таймерлер, еске салулар',
        'features.reminders.desc': 'Дайын ұйқы мен тамақтану кестелері, кез келген оқиғаға таймер, жұмсақ еске салулар. Алдын ала жоспарлаңыз — Lupibu Сіз үшін есінде сақтайды.',
        'features.multiChild.title': 'Бірнеше бала',
        'features.multiChild.desc': 'Қанша бала болса да қосыңыз — бір басумен ауысыңыз. Әр баланың өз таймлайны, графиктері мен жетістіктері бар.',
        'features.photos.title': 'Әр оқиғаға фото',
        'features.photos.desc': 'Кез келген жазбаға фото тіркеңіз — дәрігер тағайындауы, алғашқы қадам, маңызды сәт. Бәрі өз орнында — галереяда іздемейсіз.',
        'features.articles.title': 'Жасына сай мақалалар',
        'features.articles.desc': 'Педиатрлар жазған мақалалар — балаңыздың қазіргі даму кезеңіне сай. Қажет жауап қажет уақытта.',

        'howItWorks.label': 'Қалай жұмыс істейді',
        'howItWorks.title': 'Тыныш ата-аналыққа үш қадам',
        'howItWorks.step1.title': 'Балаңызды қосыңыз',
        'howItWorks.step1.desc': 'Аты, туған күні, фото — жарты минутта бәрі дайын. Балаларды қанша десеңіз, сонша қосасыз.',
        'howItWorks.step2.title': 'Айтыңыз немесе басыңыз',
        'howItWorks.step2.desc': 'Оқиғаларды дауыспен жазыңыз немесе тізімнен таңдаңыз. Таймер қойыңыз, фото тіркеңіз, өзгертіңіз — өзіңізге ыңғайлы.',
        'howItWorks.step3.title': 'Өсуін бақылаңыз',
        'howItWorks.step3.desc': 'Өсу графиктері, жетістіктер, күнделікті таймлайн — Lupibu жазбаларды қайта-қайта парақтағыңыз келетін тарихқа айналдырады.',

        'testimonials.label': 'Ата-аналар айтады',
        'testimonials.title': 'Қолданды — ұнатты',
        'testimonials.t1.text': '«Дауыспен жазуға сенбей едім. Сәбиді тербетіп отырып «банан жеді 50 грамм» дедім — бәрі өзі жазылды! Енді қолмен теруге қайтпаймын.»',
        'testimonials.t1.name': 'Анар Б.',
        'testimonials.t1.role': 'Ана, сәбиі 8 айлық',
        'testimonials.t2.text': '«Педиатрға бармас бұрын өсу графигін аштым — ұлым ДДҰ нормасында екен. Дәрігердің өзі қосымшаның атын сұрап жазып алды.»',
        'testimonials.t2.name': 'Ерлан М.',
        'testimonials.t2.role': 'Жас әке',
        'testimonials.t3.text': '«Қызым алғашқы қадамын жасағанда қосымшада конфетти ұшып, әжеге жіберуге ашықхат шықты. Әжем қуанғаннан жылап қалды!»',
        'testimonials.t3.name': 'Айгерім Т.',
        'testimonials.t3.role': 'Екі баланың анасы',

        'cta.title': 'Балаңыздың тарихы осы жерден басталады',
        'cta.subtitle': 'Негізгі мүмкіндіктер — тегін. Жарнамасыз.',

        'contact.label': 'Бізге жазыңыз',
        'contact.title': 'Сұрағыңыз бар ма? Ойыңызбен бөлісіңіз!',
        'contact.subtitle': 'Пікіріңізге қуаныштымыз. Жазыңыз — тез арада жауап береміз.',
        'contact.name': 'Аты-жөні',
        'contact.namePlaceholder': 'Атыңыз',
        'contact.email': 'Электрондық пошта',
        'contact.emailPlaceholder': 'сіздің@email.com',
        'contact.message': 'Хабарлама',
        'contact.messagePlaceholder': 'Қалай көмектесе аламыз?',
        'contact.send': 'Жіберу',
        'contact.success': 'Пошта клиенті қазір ашылады. Рахмет!',

        'footer.tagline': 'Сіз айтыңыз — біз жазамыз.',
        'footer.product': 'Өнім',
        'footer.product.features': 'Мүмкіндіктер',
        'footer.product.howItWorks': 'Қалай жұмыс істейді',
        'footer.product.contact': 'Байланыс',
        'footer.legal': 'Құжаттар',
        'footer.legal.privacy': 'Құпиялылық саясаты',
        'footer.legal.terms': 'Қолдану шарттары',
        'footer.legal.disclaimer': 'Медициналық ескерту',
        'footer.legal.dataConsent': 'Деректерді өңдеуге келісім',
        'footer.copyright': '\u00a9 2026 Lupibu. Барлық құқықтар қорғалған.',

        'meta.description': 'Lupibu — балаңыздың сенімді серігі. Тамақтану, ұйқы, ДДҰ өсу графиктері, жетістіктер, кестелер, фотолар — бәрі бір қосымшада. Дауыспен жазу жасанды интеллект арқылы.',
        'meta.title': 'Lupibu \u2014 Көз ілеспей өсіп кетеді. Бір сәтін де жіберіп алмаңыз.'
    }
};

const SUPPORTED_LANGS = ['en', 'ru', 'kk'];
const DEFAULT_LANG = 'en';

const langLabels = {
    en: 'EN',
    ru: 'RU',
    kk: 'KZ'
};

/**
 * Detect the best language: localStorage > navigator.language > default
 */
function detectLanguage() {
    const saved = localStorage.getItem('lupibu-lang');
    if (saved && SUPPORTED_LANGS.includes(saved)) return saved;

    const browserLang = (navigator.language || navigator.userLanguage || '').toLowerCase();

    if (browserLang.startsWith('ru')) return 'ru';
    if (browserLang.startsWith('kk') || browserLang.startsWith('kz')) return 'kk';

    return DEFAULT_LANG;
}

/**
 * Apply translations to all elements with data-i18n or data-i18n-html
 */
function applyTranslations(lang) {
    const dict = translations[lang] || translations[DEFAULT_LANG];

    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.textContent = dict[key];
    });

    document.querySelectorAll('[data-i18n-html]').forEach(el => {
        const key = el.getAttribute('data-i18n-html');
        if (dict[key]) el.innerHTML = dict[key];
    });

    document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (dict[key]) el.placeholder = dict[key];
    });

    // Update legal links with current language
    document.querySelectorAll('.legal-link').forEach(el => {
        const doc = el.dataset.doc;
        if (doc) el.href = 'legal.html?doc=' + doc + '&lang=' + lang;
    });

    // Update meta
    document.documentElement.lang = lang;
    const metaDesc = document.querySelector('meta[name="description"]');
    if (metaDesc && dict['meta.description']) {
        metaDesc.setAttribute('content', dict['meta.description']);
    }
    if (dict['meta.title']) {
        document.title = dict['meta.title'];
    }
}

/**
 * Set active language and update switcher UI
 */
function setLanguage(lang) {
    if (!SUPPORTED_LANGS.includes(lang)) lang = DEFAULT_LANG;
    localStorage.setItem('lupibu-lang', lang);
    applyTranslations(lang);

    // Update switcher button text
    const currentBtn = document.querySelector('.lang-current');
    if (currentBtn) currentBtn.textContent = langLabels[lang];

    // Update active state in dropdown
    document.querySelectorAll('.lang-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.lang === lang);
    });
}

/**
 * Initialize language switcher
 */
function initI18n() {
    const lang = detectLanguage();
    applyTranslations(lang);

    // Update switcher button
    const currentBtn = document.querySelector('.lang-current');
    if (currentBtn) currentBtn.textContent = langLabels[lang];

    // Mark active option
    document.querySelectorAll('.lang-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.lang === lang);
        opt.addEventListener('click', function (e) {
            e.stopPropagation();
            setLanguage(this.dataset.lang);
            // Close dropdown
            this.closest('.lang-switcher').classList.remove('open');
        });
    });

    // Toggle dropdown
    const switcher = document.querySelector('.lang-switcher');
    if (switcher) {
        switcher.querySelector('.lang-toggle').addEventListener('click', function (e) {
            e.stopPropagation();
            switcher.classList.toggle('open');
        });

        // Close on outside click
        document.addEventListener('click', () => {
            switcher.classList.remove('open');
        });
    }
}
